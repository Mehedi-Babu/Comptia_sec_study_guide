# Risk Management
Risk management is the identification, evaluation, and prioritization of risks followed by coordinated and economical application of resources to minimize, monitor, and control the probability or impact of unfortunate events or to maximize the realization of opportunities.

# Defining Risk

**Vulnerability: A weakness; System flaw**

**Threat: Exploit vulnerabilities to harm assets.**

**Risk: The likelihood of a THREAT exploiting a VULNERABILITY, resulting in a loss.**

**Formulas:**<br>
*threats x vulnerability = risk*<br>
*threats -> vulnerability = risk*

## 1) Asset:
Is a part of an IT infrastructure that has a value. You can measure value either tangibly or intangibly. A gateway router is an example of an asset with tangible value, if it fails, you can easily calculate the cost to replace the router.

Example of assets: 

Asset | Info.
--- | ---
Servers | The computers that offer shared resources
Workstations | The computers users need to do their job
Data | The stored, proprietary information an organization needs to operate
Applications | Specific programs an organization needs to use
Personnel | The people who work in an organization
Wireless access | Wireless access to the network 
Internet services | The public or private-facing resources an organization provides to customers, vendors, or personnel via the Web or the Internet applications

## 2) Probability
Probability means the likelihood - over a defined period of time - of someone or something damaging assets.

**Quantitative likelihood:** based on numbers and data, can be more easy to measure anually.

**Qualitative likelihood:** is more subjective like (low/medium/high).

## 3) Threat actors
A threat actor can be a malicious person, such as a hacker accessing corporate secrets.

**The exam cover six types of threat actor:**
* Hacktivists
* Script Kiddies
* Insiders
* Competitors
* Organized Crime
* Nation State/APT

# Risk Assessment
### 1) Vulnerability Assessment
* NIST SP 800-30
* CVE (Common Vulnerabilities and Exposures)
* Nessus scanner
* Penetration Testing

### 2) Threat Assessment
* **Environmental**: Natural disasters outside the control of humans
* **Manmade**: Any threat that is not environmental
* **Internal**: Threat generated by internal sources, usually an insider to the organization
* **External**: Threat generated from outside your infrastructure 


## Risk Response
*After identified and analyzed risk, you must decide how to responde to the risks produced as a result of the analysis.*
### **1) Risk Mitigation**
Is an attempt to reduce the risk, or at least minimize its effects on an asset.
### **2) Risk Transference**
Or Risk Sharing, deals with risk by sharing with third-party. Example buying insurance to protect against natural disasters.
### **3) Risk Acceptance**
Means the organization has implemented controls and some risk remains. (residual risk). Remember that risk can never be completely eliminated.
### **4) Risk Avoidance**
Means thtat the organization could choose not to participate in activities that cause unnecessary or excessive risk.

## Risk Frameworks
* NIST - Risk Management Framework SP 800-37
* ISACA Risk IT Framework

# Security Controls
The cornerstone of IT security is understanding security controls and how to apply them.

1) **Administrative Control** (People -> IT Security)
    * Laws
    * Policies
    * Guidelines
    * Best Practices 

2) **Technical Control** (IT Systems -> IT Security)
    * Computer stuff
    * Firewalls
    * Password links
    * Authentication
    * Encryption 

3) **Physical Control** (Physical World)
    * Gates
    * Guards
    * Mantraps
    * Keys

## Activity Phase Control Types

1) **Deterrent control**: Deters the actor from **attempting** the threat. *(Warning Sign, SSH Banner)*

2) **Preventive control**: Deters the actor from **performing** the threat. *(Fence, Server Locks, Password Complexity)*

3) **Detective control**: Recognizes an actor's threat. *(Background check, CCTV, IDS)*

4) **Corrective**: Mitigates the impact of a manifested threat. *(Backups)*

5) **Compensating**: Provides alternative fixes to any of the above functions

*Most of security controls are **preventive** phase controls*

## Interesting Security Controls
* Mandatory Vacation
* Job Rotation
* Multi-person Control
* Separation of Duties
* Principle of Least Privilege

# Defense in Depth
Every IT infrastructure might be looked at as a series of concentric shells. The location of these shells depends on the types of threats you are mitigating.

Defense in Depth uses **administrative, physical and technical controls**.

<p align="center">
Physical defense in depth
</p>
<p align="center">
<img width="70%" src="https://www.ciatec.com/wp-content/uploads/2018/03/Defense-in-Depth.jpg" />
</p>
<p align="center">
Network Defense in depth
</p>
<p align="center">
<img width="70%" src="https://d3i71xaburhd42.cloudfront.net/20d7aa23c12aaeccc823c82c785b5048dadd3058/3-Figure4-1.png" />
</p>

### **Redundacy**
Repeating the same controls at various intervals.
### **Diversity**
Try different set of security controls in a random pattern.
* **Vendor Diversity**: Uses several vendors to supply equipament and services.

# IT Governance
Influences how the organization conducts IT security.

In its most core function is to actually make the right set of security controls.

1) Laws and Regulations
* HIPAA (Health Insurance Portability and Accountability - USA)
2) Standards
* **Governament Standards**: NIST, ISO<br>
* **Industry Standards**: PCI-DSS (Payment Card Industry Data Security Standard)
3) Best Practices
4) Common-Sense

## Policies
Document that defines how we're going to be doing something. Define Roles and Responsabilities.

## Organizational Standards
Have much more detail than policies. Define the acceptable level of performance policy.

*The security controls come from the policies and standards.*

## Procedures
Step by step process of how to do something.

Security controls, Policies and standards help define and build the **Procedures**.

<p align="center">
<img width="75%" src="https://gist.githubusercontent.com/Samsar4/62886aac358c3d484a0ec17e8eb11266/raw/0aff7f60c0b9b6bf8d8c420fd2ded843eb29984d/it-governance.jpg" />
</p>

# Security Policies
### **The Acceptable Use Policy (AUP)**:
Defines what a person can or can not do when using company assets and equipament. *(The paper you sign before entry a job position).*

### **Data Sensitivity and Classification Policies**:
Define the importance or nature of the data. *(i.e. Applying labels on the Government, they use Top Secret, Classified, etc).*

### **Access Control Policies**:
* How people get access to data or resources
* What type of data do users have access to.
* Data access and classification restrictions 
*(It cover a lot of things based on the job type).*

### **Password Policy:**
* Password recovery
* Password retention
* Bad login attempt
* Password reuse
* Complexity

### **Care and Use of Equipament**
How you maintain company equipament.

### **Privacy Policy**:
Are often for customers; defines how your data or usage will be shared with other resoruces. *(i.e. Services like Facebook etc).*

### **Personnel Policies**:
* Background Check
* Mandatory Vacation
* Job Rotation
* Separation of Duties
* Multi-person Control

# Risk Management Frameworks
A framework is a description of a complex process, concentranting on major steps and the flows between the steps. **Describes the major steps and flows of the complex process of applying security controls in an organized and controlled fashion.**

Frameworks come from a variety of sources including:
* **Regulatory**
* **Non-Regulatory**
* **National**
* **Industry Standards (Best Practices)**

## Popular RMF 

**National Standard and Regulatory:**
* NIST SP 800-37

**Non-Regulatory**:
* ISACA IT Infrastructure

**International Standard**:
* ISO 27000

<p align="center">
<b>NIST Risk Management Framework:</b>
</p>
<p align="center">
<img width="70%" src="https://csrc.nist.gov/CSRC/media/Projects/Risk-Management/images-media/OrgRMF.png" /> </p>

# Quantitative Risk Assessment
Is based on objective data -typically, numerical data; Exact values, for instance, can be used to describe impact or loss of an asset.

## Asset Value (AV)
When valuing an asset, consider not only the replacement cost, but also the revenue the asset generates, as this will be lost as well if the asset is not available.


*Example:*

Asset | Cost | Repair | Revenue | = Total
--|--|--|--|--
**Router** | €600 | €500 x day | €2000 x day | €3100

## Exposure Factor (EF)
The percentage of an asset that could be lost during a negative event. Realistically, you will not always lose 100% (1) of the asset; you may lose only 20% (0.2) or 50% (0.5) for example. 

*Example:*

Incident | Exposure Value
--|--
Flood | 1 (100%)

## Single Loss Expectancy (SLE)
Is the value that's computed simply by multiplying the asset's value by the exposure factor (percentage of loss).

**Formula:**<br>
Single Loss Expectancy = Asset Value x Exposure Factor<br>
**SLE = AV x EF**

*Example (using data below):*

AV | x  EF | = SLE
--|--|--
€3100 | 1 | €3100 

SLE = €3100 (AV) x 1 (EF) = €3100 

## Annualized Rate of Occurrence (ARO)
How many times per year you would expect a particularly negative event to occur, resulting in a loss of the asset. **This value relates more to likelihood than impact.**

*Example:*
Flood on Server room, base on data: one flood in about 10 years, 1/10 (0.1). [SLE x ARO = ALE]

## Annualized Loss Expectancy (ALE)
Essentially looks at the amount of loss from the SLE and determines how much loss the organization could realistically expect in a one-year period. 

**Formula**:<br>
ALE (Annualized loss expectancy) = SLE x ARO<br>
**SLE x ARO = ALE**


# Business Impact Analysis
Designed to mitigate the effects of an incident, **not to prevent an incident**.

* Determine mission process. *(make sure servers are up)*
* Identify critical systems.
* Single point-of-failure. *(using Defense-in-Depth...)*
* Identify resource requirements.
* Identify recovery priorities. *(prioritize most important steps to kepp whatever essential function running)*

## Types of Impact
* Property
* Safety / Life / People
* Finance (Credit, Cash flows...)
* Reputation
* Privacy

### **Privacy Impact Assessment (PIA) and Privacy Threshold Assessment (PTA)**
PIA: Determine the impact on the privacy of the individuals who data is beign stored; and ensure that the organization has sufficient security controls applied to be within compliance of applicable laws or standards.

To create a **(PIA) - Privacy Impact Assessment**, the organization needs to perform a **(PTA) - Privacy Threshold Assessment** on its infrastructure to locate **personal information**, what personal info. is stored and from whom the personal info is collected.

*PTA and PIA - in order to understand the impact of the loss of personal information can do to a particular business.*

## Calculating Impact
Determine how long the particular equipament going to last. (qualitative)

<p align="center">
<img  width="70%" src="https://gist.githubusercontent.com/Samsar4/62886aac358c3d484a0ec17e8eb11266/raw/13cf0c9fbcd0acba680220cce03829cbf0ce1506/MTBF.png" />
</p>

* **MTTF = Mean Time to Failure**
* **MTTR = Mean Time to Repair**
* **MTBF = Mean Time Between Failure**

## Recovery Time Objective (RTO):
* Maximum amount of time that a resource may remain unavailable before an unacceptable impact on other system resources occurs.
## Recovery Point Objective (RPO):
* Defines de amount of time that will pass between an incident and recovery from backup.

*Recovery priorities help define what needs to be addressed to maintain business continuity.*

# Organizing Data
The first step to dealing with data security is **organization**.

* Analyze individual chuncks of data (such as databases, files, access control lists..)
* Determine the importance - **the sensitivity of data.**

## Data Sensitivity | Labeling
* **Public Data**: Has no restrictions. (stills needs integrity and availability)

* **Confidential Information**: Limited to authorized viewing as agreed by the parties involved.

* **Private Information**:social security number, passport number, PII - Peronally identifiable information...

* **Proprietary Information**: Information owned by a company that gives a certain competitive advantages. (i.e. The secret formula of Coca-Cola).

* **PHI - Protected Health Information**: Not only Health information, PII may include on PHI.

## Data Roles
* **Owner of the data / Data Owner**: Legally responsible for the data, can be entity responsible.

* **Steward / Custodian**: Maintain the accuracy and integrity of data.

* **Privacy Officer**: Ensures data adhere to privacy policies and procedures.

## User Roles
* **Users**: Assigned standard permissions to complete tasks. | Must understand how system functions works and have proper security training to recognize common issues (Malware, etc).

* **Privileged Users**: Increased access and control over the data or system. (i.e. a Normal user can run anti-malware software, but the privileged can updated then).

* **Executive Users**: Concentrates on strategic decisions including policy review, incident response and disaster recovery.

* **System Administrator**: Has complete direct control over the data or system. (Can remove or add users, applying permissions, and doing system maintance...) 

* **Data Owner | System Owner**: People or organizations who have legal ownership of this particular data set or particular system.

# Security Training

### **Onboarding**:
New hires or contractors
* Background check
* NDA (Non-disclosure agrement)
* Standard Operation Procedures
* Specialized Issues (i.e. Clean Desk)
* Rules of Behavior (i.e. Good AUP)
* General Security Policies (i.e. Personal Email, Social network...)

### **Offboarding**:
When the employee leaves the company
* Disable accounts (never delete an account)
* Return Credentials
* Exit interview
* Knowledge transfer

## Personnel Management Controls
* **Mandatory Vacation**: 
    * Required
    * Prevents collusion
    * Dependency issues
    * Makes fraud harder

* **Job Rotation**:
    * Redundancy and Backup
    * Allows for cross-training
    * Makes fraud harder

* **Separation of Duties**:
    * Requires dual execution *(at least two people to do a sensitive function)*

* **Multi-Person control**:
    * Moren than one person required in a task/function

## Role-Based Data Controls
* **System Owner**:
    * Management level role
    * Maintains security of the system
    * Defines a system administrator
    * Works with all **Data Owners** to ensure data security

* **System Administrator**:
    * Day-to-day administration of a system
    * Implement security controls

* **Data Owner**:
    * Defines the sensitivity of the data
    * Defines the protection of the data
    * Works with **System Owner** to protect data
    * Defines access to the data

* **User**:
    * Accesses and uses the assigned data responsibly
    * Monitors and reports security breaches

* **Privileged**:
    * Has special access to data beyond the typical user
    * Works closely with **System Administrators** to ensure data security

* **Executive User**:
    * **Read only** access but can look at all business data

# Third-Party Risk / Agreements

### **Business Partnership Agreement (BPA)**:
Most common used in private sector.

* Primary entities
* Time frame
* Financial issues
* Management

### **Service Level Agreement (SLA)**:
Used in private sector.

* Agreement between who is getting the service and service provider
* Service to be provided
* Minimum up-time
* Response time (contacts)
* Start and End date

### **Interconnection Security Agreement (ISA)**:
Is a technical Agreement used on public sector.

* Statement of Requirements
    * *Why are we interconnecting?*
    * *What system is interconnecting?*
* System secuirty considerations
    * *What information is interconnecting?*
    * *Where is this information going?*
    * *What services are involved?*
    * *What encryption is needed?*
* Topological drawing
* Signature authoring
    * Time frame for the interconnection
    * Technical and security reviews from them

### **Memorandum of Understanding/Agreement (MOU / MOA)**:
Agreement used in public sector.

* The purpose of the interconnection
* Relevant authorities *(Who is on charge?)*
* Specify the responsabilities
    * Downtime
    * Billing
* Define the terms of the agreement
    * Cost
* Termination/reauthorization